<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="description" content="" />
<meta name="author" content="" />
<meta name="keywords" content="" />
<meta name="copyright" content="" />
<meta name="generator" content="" />

<!-- Head & Title include -->
<title>ADD / EDIT News</title>
<script src="assets/js/bbcode.js" language="jscript" type="text/javascript"></script>
<!-- end Head & Title include -->

<script language="JavaScript" type="text/JavaScript">
<!-- 
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}

default_language = "uk";

intro = new Array();
message = new Array();
headline = new Array();
langs = new Array();

news_languages = new Array();
$langs

function update_language() {
	delete_array = new Array();
	for(var i = 0; i < news_languages.length; i++) {
		delete_array[i] = new Array(0, null);
	}
	for(var i = 0; i < langs.length; i++) {
		option = document.getElementById('lang_' + i);
		for(var z = 0; z < news_languages.length; z++) {
			if(option.options[z].selected == true) {
				delete_array[z][0] = 1;
				delete_array[z][1] = i;
			}
		}
	}
	for(var i = 0; i < langs.length; i++) {
		option = document.getElementById('lang_' + i);
		for(var z = 0; z < news_languages.length; z++) {
			if(delete_array[z][0] == 1 && delete_array[z][1] != i) {
				option.options[z].disabled = true;
				option.options[z].style.backgroundColor = '#B10000';
				option.options[z].style.display = 'none';
			}
			else {
				option.options[z].disabled = false;
				option.options[z].style.backgroundColor = '#FFFFFF';
				option.options[z].style.display = '';
			}
		}
	}
}

function initialize_language() {
	delete_array = new Array();
	for(var i = 0; i < news_languages.length; i++) {
		delete_array[i] = 0;
	}
	for(var i = 0; i < langs.length; i++) {
		option = document.getElementById('lang_' + i);
		for(var z = 0; z < news_languages.length; z++) {
			new_option = new Option(news_languages[z][1], news_languages[z][0], false, false);
			option.options[z] = new_option;
			if(langs[i] != '') {
				if(langs[i] == news_languages[z][0]) {
					option.options[z].selected = true;
					delete_array[z] = 1;
				}
			}
			else if(i == 0 && news_languages[z][0] == default_language) {
				option.options[z].selected = true;
				delete_array[z] = 1;
				langs[i] = news_languages[z][0];
			}
			else if(i != 0 && delete_array[z] == 0) {
				option.options[z].selected = true;
				delete_array[z] = 1;
				langs[i] = news_languages[z][0];
			}
		}
	}
}
function update_textarea(value) {
	document.getElementById('news_textarea').innerHTML='';
	for(var i = 0; i < value; i++) {
		if(intro[i] || message[i] || headline[i] || langs[i] && langs[i] != default_language)
		{
			document.getElementById('news_textarea').innerHTML+='<select name="lang[]" id="lang_' + i + '" onchange="langs['+i+']=this.value; update_language();"></select> %headline% <input name="headline[]" type="text" value="'+headline[i]+'" size="80" onchange="headline['+i+']=this.value;" /><h1>Intro</h1><textarea name="intro[' + i + ']" style="width:  97%; height:85px;" onfocus="which=this;textarea = \'intro[' + i + ']\';" onblur="intro['+i+']=this.value;" onchange="intro['+i+']=this.value;">'+intro[i]+'</textarea><h1>Full Length</h1><textarea name="message[' + i + ']" style="width:  97%; height:120px;" onfocus="which=this;textarea = \'message[' + i + ']\';" onblur="message['+i+']=this.value;" onchange="message['+i+']=this.value;">'+message[i]+'</textarea>';
		}
		else
		{
			intro[i] = '';
			message[i] = '';
			headline[i] = '';
			langs[i] = '';
			document.getElementById('news_textarea').innerHTML+='<select name="lang[]" id="lang_' + i + '" onchange="langs['+i+']=this.value; update_language();"></select> %headline% <input name="headline[]" type="text" value="" size="80" onchange="headline['+i+']=this.value;" /><h1>Intro</h1><textarea name="intro[' + i + ']" style="width: 97%; height:85px;" onfocus="which=this;textarea = \'intro[' + i + ']\';" onblur="intro['+i+']=this.value;" onchange="intro['+i+']=this.value;"></textarea><h1>Full Length</h1><textarea name="message[' + i + ']" style="width:  97%; height:120px;" onfocus="which=this;textarea = \'message[' + i + ']\';" onblur="message['+i+']=this.value;" onchange="message['+i+']=this.value;"></textarea>';
		}
	}
	
	
	if(message.length > value) {
		var message_length = message.length;
		for(var i = value; i < message_length; i++) {
			delete intro[i];
			intro.length--;
			delete message[i];
			message.length--;
			delete headline[i];
			headline.length--;
			delete langs[i];
			langs.length--;
		}
	}
	
	initialize_language();
	update_language();
}

function chkFormular() {
	
	if(document.getElementsByName('headline[]')[0].value == "") {
		alert("%enter_title%");
		document.getElementsByName('headline[]')[0].focus();
   		return false;
	}
	

	if(!validbbcode(intro_text)){
		return false;
	}
	
}

$intro_vars
$message_vars
$headline_vars
$langs_vars

-->
</script>
<style type="text/css">
* { margin: 0px; padding: 0px; outline: none; }
html, body { background: #0c0d0f; font-family: Tahoma, Geneva, sans-serif; font-size: 12px; color: #fff; }
html { padding: 15px; }

/* Links */
a, a:link, a:visited { color: #fff; text-decoration: none; font-family: Tahoma, Geneva, sans-serif; -webkit-transition: all 0.3s ease-in ; -moz-transition: all 0.3s ease-in ; -ms-transition: all 0.3s ease-in ; -o-transition: all 0.3s ease-in ; transition: all 0.3s ease-in ; }
a:hover { color: #f26722; }

/* Resets */
::selection { background: #999; color: #fff; text-shadow: none; }
ul { list-style: none; }
li { list-style: none; }

::-webkit-scrollbar { width: 12px; }
::-webkit-scrollbar-track-piece { background: #222; }
::-webkit-scrollbar-thumb { background: #666; border-radius: 3px; border: 1px #222 solid; -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); }
::-webkit-scrollbar-corner { display: none; }
::-webkit-resizer { display: none; }

/* Forms */
form { border: none; margin: 0px; padding: 0px; }
input { border: none; font-size: 12px; font-family: Tahoma, Geneva, sans-serif; background: #222222; border-radius: 2px; -moz-border-radius: 2px; -webkit-border-radius: 2px; color: #999999; padding: 5px 7px 5px 7px; color: #999;  border: 1px #302f2f solid; margin: 3px 0px 3px 0px; }
input[type=submit], input[type=button] { border: none; font-size: 12px; font-family: Tahoma, Geneva, sans-serif; background: #343434; border-radius: 2px; -moz-border-radius: 2px; -webkit-border-radius: 2px; color: #999999; padding: 5px 7px 5px 7px; color: #fff; box-shadow: 0 0 7px #000; margin: 3px 0px 3px 0px; cursor: pointer; }
input[type=submit], input[type=button]:hover { background: #2B5C8D; }
select { border: none; font-size: 12px; font-family: Tahoma, Geneva, sans-serif; background: #222222; border-radius: 2px; -moz-border-radius: 2px; -webkit-border-radius: 2px; color: #999999; padding: 5px 7px 5px 7px; color: #999; border: 1px #302f2f solid; margin: 3px 0px 3px 0px; }
option { border: 0px; }
textarea { background: #222222; border-radius: 2px; padding: 10px; color: #999; border: 1px #302f2f solid; }

/* Wrappers */
#wrapper { background: #1d1d1d; width: 100%; box-shadow: 0 0 7px #080808; border-radius: 3px; float: left; }

#header { background:url(sm/core/blue_bg.png); width: 100%; height: 39px; float: left; }
#header h1 { font-size: 14px; margin: 10px 0px 0px 10px; float: left; }

#content { width: 100%; float: left; }
#content-inner { width: 96%; margin: 2%; float: left; }
#content-inner h1 { width: 100%; padding: 0px 0px 2px 0px; margin: 10px 0px 10px 0px; border-bottom: 1px dotted #505050; color: #999; font-size: 14px; float: left; }

#content-inner ul { width: 100%; float: left; }
#content-inner ul li { width: 33%; float: left; }

/* Infomessages - Miscellaneous */
.tooltip {
  position: absolute;
  display: none;
  background-color: #FFFFFF;
  color: #000000;
  border: 1px solid #DDDDDD;
  border-left: 4px solid #0E8AEA;
  padding: 4px 10px;
  z-index: 100;
}
</style>

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css">
  <style>
  .custom-combobox {
    position: relative;
    display: inline-block;
  }
  .custom-combobox-toggle {
    position: absolute;
    top: 0;
    bottom: 0;
    margin-left: -1px;
    padding: 0;
  }
  .custom-combobox-input {
    margin: 0;
    padding: 5px 10px;
  }
  </style>
  <script>
  (function( $ ) {
    $.widget( "custom.combobox", {
      _create: function() {
        this.wrapper = $( "<span>" )
          .addClass( "custom-combobox" )
          .insertAfter( this.element );
 
        this.element.hide();
        this._createAutocomplete();
        this._createShowAllButton();
      },
 
      _createAutocomplete: function() {
        var selected = this.element.children( ":selected" ),
          value = selected.val() ? selected.text() : "";
 
        this.input = $( "<input>" )
          .appendTo( this.wrapper )
          .val( value )
          .attr( "title", "" )
          .addClass( "custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left" )
          .autocomplete({
            delay: 0,
            minLength: 0,
            source: $.proxy( this, "_source" )
          })
          .tooltip({
            tooltipClass: "ui-state-highlight"
          });
 
        this._on( this.input, {
          autocompleteselect: function( event, ui ) {
            ui.item.option.selected = true;
            this._trigger( "select", event, {
              item: ui.item.option
            });
          },
 
          autocompletechange: "_removeIfInvalid"
        });
      },
 
      _createShowAllButton: function() {
        var input = this.input,
          wasOpen = false;
 
        $( "<a>" )
          .attr( "tabIndex", -1 )
          .attr( "title", "Show All Items" )
          .tooltip()
          .appendTo( this.wrapper )
          .button({
            icons: {
              primary: "ui-icon-triangle-1-s"
            },
            text: false
          })
          .removeClass( "ui-corner-all" )
          .addClass( "custom-combobox-toggle ui-corner-right" )
          .mousedown(function() {
            wasOpen = input.autocomplete( "widget" ).is( ":visible" );
          })
          .click(function() {
            input.focus();
 
            // Close if already visible
            if ( wasOpen ) {
              return;
            }
 
            // Pass empty string as value to search for, displaying all results
            input.autocomplete( "search", "" );
          });
      },
 
      _source: function( request, response ) {
        var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
        response( this.element.children( "option" ).map(function() {
          var text = $( this ).text();
          if ( this.value && ( !request.term || matcher.test(text) ) )
            return {
              label: text,
              value: text,
              option: this
            };
        }) );
      },
 
      _removeIfInvalid: function( event, ui ) {
 
        // Selected an item, nothing to do
        if ( ui.item ) {
          return;
        }
 
        // Search for a match (case-insensitive)
        var value = this.input.val(),
          valueLowerCase = value.toLowerCase(),
          valid = false;
        this.element.children( "option" ).each(function() {
          if ( $( this ).text().toLowerCase() === valueLowerCase ) {
            this.selected = valid = true;
            return false;
          }
        });
 
        // Found a match, nothing to do
        if ( valid ) {
          return;
        }
 
        // Remove invalid value
        this.input
          .val( "" )
          .attr( "title", value + " didn't match any item" )
          .tooltip( "open" );
        this.element.val( "" );
        this._delay(function() {
          this.input.tooltip( "close" ).attr( "title", "" );
        }, 2500 );
        this.input.autocomplete( "instance" ).term = "";
      },
 
      _destroy: function() {
        this.wrapper.remove();
        this.element.show();
      }
    });
  })( jQuery );
 
  $(function() {
    $( "#combobox" ).combobox();
    $( "#toggle" ).click(function() {
      $( "#combobox" ).toggle();
    });
  });
  </script>
  
  
</head>
<body>
<form action="_news.php?action=save" method="post" enctype="multipart/form-data" id="post" name="post" onsubmit="return chkFormular();">

<div id="wrapper">
  <div id="header">
    <h1>ADD / EDIT NEWS</h1>
  </div>
  <div id="content">
    <div id="content-inner">
      <ul>
		<li>
		  <b>News OR Link?</b><br /><br />
		  <select name="blog" style="background: red">$blog</select>
		</li>
        <li>
          Rubric<br /><br />
          <select name="rubric">$rubrics</select>
          <input name="button" type="button" onclick="MM_openBrWindow('upload.php?newsID=$newsID','Upload','scrollbars=yes,width=800,height=600')" value="%upload_images%" /><br /><br />
        </li>
		<li>
		  Top News<br /><br />
		  <select name="topnews">$topnews</select>
		</li>
      </ul>
      <ul>
      <li><br />Newspic frontpage<br /><br />
            <input name="banner" type="file" /><br /><br />
      </li>
      </ul>
	  <ul>
      <li><br /><b>Press Link:<br /><br />
      <input type="text" name="url1" size="60" value="$ds[url1]" /><br /><br />
	  </li>
	  </ul>
      <ul>
      <li>Newspic<br /><br />
            <input name="banner2" type="file" /> <br /><br />
      </li>
      </ul>
      <ul><li style="width: 100%"><div>$addbbcode</div></li></ul>

      <div id="news_textarea">      </div>
	  <script language="JavaScript" type="text/javascript">
      /* <![CDATA[ */
      update_textarea($langcount);
      /* ]]> */
      </script>
      <div style="margin: 10px 0px 0px 0px;float: left;">
      <input type="hidden" name="userID" value="$userID" />
      <input type="hidden" name="newsID" value="$newsID" />
      <select name="comments">$comments</select>
      <input type="submit" name="preview" value="%preview%" />
      <input type="submit" name="save" value="%save_news%" />
      <input type="button" onclick="window.close()" value="%cancel%" />
      </div>
    </div>
  </div>
</div>

</form>
</body>
</html>
